#!/usr/bin/env ruby

require 'rubygems'
require 'termios'
require 'rawline'
require 'lib/client'

class Object
  # Метод для быстрой справки по методам текущего объекта
  def m
    if [Module, Class].include? self.class
      public_methods - self.class.public_instance_methods
    else
      class << self
        self.public_instance_methods false
      end
    end
  end  
end

module Kernel
  # Перезагружаем все файлы (чтобы не перезапускать консоль в случае редактирования кода)
  def reload
    Dir.glob('lib/**/*.rb').each {|file| load file }
  end
  
  def r
    Robot
  end  
end

Client.connect

editor = RawLine::Editor.new
loop do
  cmd = editor.readline '>> '
  editor.history.push cmd
  begin
    p eval(cmd)
  rescue => e
    puts e
  end
end